{% extends "inc/layout.html" %}
{% from "inc/forms.html" import renderfield %}
{% block title %}List a classified{% endblock %}
{% block content %}
<div id="sheet">
  <div class="section first">
    <h1>
      {{ self.title()|e }}
    </h1>
  </div>
  <form id="newjob" enctype="multipart/form-data" method="POST">
    <input type="hidden" name="_charset_"/>
    <input type="hidden" name="form.id" value="newjob"/>
    {{ form.csrf() }}
    <div class="section">
      {% if form.csrf.errors %}
        {% for error in form.csrf.errors %}<div class="error">{{ error }}</div>{% endfor %}
      {% endif %}
      {{ renderfield(form.job_headline, "small", autofocus=True) }}
      {{ renderfield(form.job_location, "small") }}
      {% if not no_email %}{{ renderfield(form.poster_email, "small") }}{% endif %}
      {{ renderfield(form.job_description, "wide", widget_css_class="tinymce") }}
      <input type="submit" value="Review your job listing &rarr;"/>
    </div>
  </form>
</div>
{% endblock %}
{% block footerscripts %}
<script type="text/javascript">
  $(function() {
  	$('textarea.tinymce').tinymce({
      // Location of TinyMCE script
      script_url : '{{ url_for("static", filename="js/libs/tiny_mce/tiny_mce.js") }}',

      // General options
      theme : "advanced",
      plugins : "",

  		// Theme options
      theme_advanced_buttons1 : "bold,italic,|,bullist,numlist,|,outdent,indent,|,link,unlink",
      theme_advanced_buttons2 : "",
      theme_advanced_buttons3 : "",
      theme_advanced_toolbar_location : "top",
      theme_advanced_toolbar_align : "left",
      theme_advanced_statusbar_location : "bottom",
      theme_advanced_resizing : true,
      theme_advanced_path : false,

      valid_elements : "p,br,strong/b,em/i,ul,ol,li,a[!href|title|target]",
      width: "730",
      height: "400",

      {# // This totally breaks Firefox
    	{%- if config['TYPEKIT_CODE'] %}

      oninit: function() {
      	// Now attach TypeKit to the TinyMCE iframe
        $('div.control iframe').each(function(index) {
          var element = $(this)[0];
        	var script = element.contentDocument.createElement('script');
          script.type = "text/javascript";
          script.src = "http://use.typekit.com/{{ config['TYPEKIT_CODE'] }}.js";
          script.onload = function() {
            try {
              element.contentDocument.Typekit.load({
                  loading: function() {
                      element.contentDocument.designMode = "on";
                  }
              });}
            catch(err) {
              element.contentDocument.designMode = "on";
            }
          };
          element.contentDocument.designMode = "off";
          element.contentDocument.head.appendChild(script);
        });
      },

      {% endif %} #}
  		// Content CSS
      content_css : "{{ url_for('static', filename='css/editor.css') }}"
      
  	});
  });
</script>
{% endblock %}
